-- ============================================
-- –ù–ê–ß–ê–õ–¨–ù–´–ï –ü–†–ï–î–ú–ï–¢–´ –î–õ–Ø –°–ò–°–¢–ï–ú–´ –ò–ù–í–ï–ù–¢–ê–†–Ø
-- ============================================

-- –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
-- DELETE FROM character_inventory;
-- DELETE FROM items;

-- –û–†–£–ñ–ò–ï
INSERT INTO items (item_key, name, description, rarity, type, subtype, icon, level_requirement, base_damage, base_crit_chance, base_value, max_durability) VALUES
('wooden_sword', '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–µ—á', '–ü—Ä–æ—Å—Ç–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –º–µ—á –∏–∑ –¥—É–±–∞. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤.', 'common', 'weapon', '–û–¥–Ω–æ—Ä—É—á–Ω—ã–π –º–µ—á', 'üó°Ô∏è', 1, 15, 2.0, 25, 50),
('iron_sword', '–ñ–µ–ª–µ–∑–Ω—ã–π –º–µ—á', '–ù–∞–¥–µ–∂–Ω—ã–π –∫–ª–∏–Ω–æ–∫ –∏–∑ –∑–∞–∫–∞–ª–µ–Ω–Ω–æ–π —Å—Ç–∞–ª–∏. –ò–∑–ª—é–±–ª–µ–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö –≤–æ–∏–Ω–æ–≤.', 'common', 'weapon', '–û–¥–Ω–æ—Ä—É—á–Ω—ã–π –º–µ—á', '‚öîÔ∏è', 5, 45, 5.0, 150, 100),
('silver_blade', '–°–µ—Ä–µ–±—Ä—è–Ω—ã–π –∫–ª–∏–Ω–æ–∫', '–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ –æ—Ä—É–∂–∏–µ –∏–∑ —á–∏—Å—Ç–æ–≥–æ —Å–µ—Ä–µ–±—Ä–∞. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ—Ç–∏–≤ –Ω–µ–∂–∏—Ç–∏.', 'uncommon', 'weapon', '–û–¥–Ω–æ—Ä—É—á–Ω—ã–π –º–µ—á', 'üó°Ô∏è', 10, 75, 8.0, 400, 120),
('enchanted_staff', '–ó–∞—á–∞—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Å–æ—Ö', '–ü–æ—Å–æ—Ö –ø—É–ª—å—Å–∏—Ä—É–µ—Ç –º–∞–≥–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π. –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∏–ª—É –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π.', 'rare', 'weapon', '–ü–æ—Å–æ—Ö', 'ü™Ñ', 15, 35, 3.0, 800, 80),
('dragons_claw', '–ö–æ–≥–æ—Ç—å –¥—Ä–∞–∫–æ–Ω–∞', '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ –æ—Ä—É–∂–∏–µ, –≤—ã–∫–æ–≤–∞–Ω–Ω–æ–µ –∏–∑ –∫–æ–≥—Ç—è –¥—Ä–µ–≤–Ω–µ–≥–æ –¥—Ä–∞–∫–æ–Ω–∞.', 'legendary', 'weapon', '–ö–∏–Ω–∂–∞–ª', 'üó°Ô∏è', 25, 120, 25.0, 3000, 200),
('shadowbane', '–¢–µ–Ω–µ–≤–æ–π –±–∏—á', '–ú–∏—Ñ–∏—á–µ—Å–∫–æ–µ –æ—Ä—É–∂–∏–µ, —Å–ø–æ—Å–æ–±–Ω–æ–µ —Ä–∞–∑—Ä–µ–∑–∞—Ç—å —Å–∞–º—É —Ç—å–º—É.', 'mythic', 'weapon', '–î–≤—É—Ä—É—á–Ω—ã–π –º–µ—á', '‚öîÔ∏è', 35, 200, 35.0, 15000, 300);

-- –ë–†–û–ù–Ø
INSERT INTO items (item_key, name, description, rarity, type, subtype, icon, level_requirement, base_defense, base_health, base_value, max_durability) VALUES
('leather_armor', '–ö–æ–∂–∞–Ω–∞—è –±—Ä–æ–Ω—è', '–õ–µ–≥–∫–∞—è –±—Ä–æ–Ω—è –∏–∑ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –∫–æ–∂–∏. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–∞–∑–æ–≤—É—é –∑–∞—â–∏—Ç—É.', 'common', 'armor', '–õ–µ–≥–∫–∞—è –±—Ä–æ–Ω—è', 'ü¶∫', 1, 25, 50, 100, 80),
('chain_mail', '–ö–æ–ª—å—á—É–≥–∞', '–ö–æ–ª—å—á—É–∂–Ω—ã–π –¥–æ—Å–ø–µ—Ö –∏–∑ —Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–ª–µ—Ü. –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –∑–∞—â–∏—Ç—ã –∏ –º–æ–±–∏–ª—å–Ω–æ—Å—Ç–∏.', 'uncommon', 'armor', '–°—Ä–µ–¥–Ω—è—è –±—Ä–æ–Ω—è', 'üõ°Ô∏è', 8, 60, 100, 350, 120),
('plate_armor', '–õ–∞—Ç–Ω—ã–µ –¥–æ—Å–ø–µ—Ö–∏', '–¢—è–∂–µ–ª—ã–µ —Å—Ç–∞–ª—å–Ω—ã–µ –¥–æ—Å–ø–µ—Ö–∏. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–ª—è –≤–æ–∏–Ω–æ–≤.', 'rare', 'armor', '–¢—è–∂–µ–ª–∞—è –±—Ä–æ–Ω—è', 'üõ°Ô∏è', 15, 150, 200, 1200, 200),
('dragon_scale_armor', '–î–æ—Å–ø–µ—Ö –∏–∑ —á–µ—à—É–∏ –¥—Ä–∞–∫–æ–Ω–∞', '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –¥–æ—Å–ø–µ—Ö, –≤—ã–∫–æ–≤–∞–Ω–Ω—ã–π –∏–∑ —á–µ—à—É–∏ –¥—Ä–µ–≤–Ω–µ–≥–æ –∫—Ä–∞—Å–Ω–æ–≥–æ –¥—Ä–∞–∫–æ–Ω–∞. –î–∞—Ä—É–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç –æ–≥–Ω—è.', 'legendary', 'armor', '–¢—è–∂–µ–ª–∞—è –±—Ä–æ–Ω—è', 'üõ°Ô∏è', 25, 120, 200, 5000, 150);

-- –ê–ö–°–ï–°–°–£–ê–†–´
INSERT INTO items (item_key, name, description, rarity, type, subtype, icon, level_requirement, base_mana, base_crit_chance, base_speed, base_value, max_durability, set_name) VALUES
('mystic_ring', '–ö–æ–ª—å—Ü–æ –º–∏—Å—Ç–∏–∫–∞', '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∫–æ–ª—å—Ü–æ –ø—É–ª—å—Å–∏—Ä—É–µ—Ç –º–∞–≥–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–µ–π.', 'epic', 'accessory', '–ö–æ–ª—å—Ü–æ', 'üíç', 15, 100, 12.0, 8.0, 800, NULL, NULL),
('amulet_of_power', '–ê–º—É–ª–µ—Ç —Å–∏–ª—ã', '–î—Ä–µ–≤–Ω–∏–π –∞–º—É–ª–µ—Ç, –¥–∞—Ä—É—é—â–∏–π —Å–≤–æ–µ–º—É –≤–ª–∞–¥–µ–ª—å—Ü—É –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—É—é –º–æ—â—å.', 'legendary', 'accessory', '–ê–º—É–ª–µ—Ç', 'üìø', 20, 80, 15.0, 5.0, 2000, NULL, '–ö–æ–º–ø–ª–µ–∫—Ç –ê—Ä—Ö–∏–º–∞–≥–∞'),
('shadow_cloak', '–ü–ª–∞—â —Ç–µ–Ω–µ–π', '–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞—â –¥–µ–ª–∞–µ—Ç —Å–≤–æ–µ–≥–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø–æ—á—Ç–∏ –Ω–µ–≤–∏–¥–∏–º—ã–º.', 'mythic', 'accessory', '–ü–ª–∞—â', 'ü¶π', 30, 50, 20.0, 25.0, 8000, NULL, NULL);

-- –†–ê–°–•–û–î–ù–ò–ö–ò
INSERT INTO items (item_key, name, description, rarity, type, subtype, icon, level_requirement, base_health, base_mana, base_value, stackable, max_stack) VALUES
('health_potion_small', '–ú–∞–ª–æ–µ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è', '–ü—Ä–æ—Å—Ç–æ–µ –ª–µ—á–µ–±–Ω–æ–µ –∑–µ–ª—å–µ –∫—Ä–∞—Å–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞.', 'common', 'consumable', '–ó–µ–ª—å–µ', 'üß™', 1, 50, 0, 15, true, 10),
('health_potion_large', '–ë–æ–ª—å—à–æ–µ –∑–µ–ª—å–µ –ª–µ—á–µ–Ω–∏—è', '–ú–æ—â–Ω–æ–µ –∑–µ–ª—å–µ –∏—Å—Ü–µ–ª–µ–Ω–∏—è —Å –ø—Ä–∏—è—Ç–Ω—ã–º –º—è—Ç–Ω—ã–º –≤–∫—É—Å–æ–º.', 'rare', 'consumable', '–ó–µ–ª—å–µ', 'üç∂', 10, 150, 0, 75, true, 5),
('mana_potion', '–ó–µ–ª—å–µ –º–∞–Ω—ã', '–°–≤–µ—Ç—è—â–∞—è—Å—è —Å–∏–Ω—è—è –∂–∏–¥–∫–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞–≥–∏—á–µ—Å–∫—É—é —ç–Ω–µ—Ä–≥–∏—é.', 'uncommon', 'consumable', '–ó–µ–ª—å–µ', 'üß™', 1, 0, 50, 25, true, 8),
('elixir_of_strength', '–≠–ª–∏–∫—Å–∏—Ä —Å–∏–ª—ã', '–†–µ–¥–∫–∏–π —ç–ª–∏–∫—Å–∏—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫—É—é —Å–∏–ª—É.', 'epic', 'consumable', '–≠–ª–∏–∫—Å–∏—Ä', '‚öóÔ∏è', 15, 0, 0, 200, true, 3);

-- –ú–ê–¢–ï–†–ò–ê–õ–´ –î–õ–Ø –ö–†–ê–§–¢–ò–ù–ì–ê
INSERT INTO items (item_key, name, description, rarity, type, subtype, icon, level_requirement, base_value, stackable, max_stack) VALUES
('iron_ore', '–ñ–µ–ª–µ–∑–Ω–∞—è —Ä—É–¥–∞', '–ë–∞–∑–æ–≤—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –∫—É–∑–Ω–µ—á–Ω–æ–≥–æ –¥–µ–ª–∞.', 'common', 'material', '–†—É–¥–∞', '‚õèÔ∏è', 1, 5, true, 50),
('silver_ore', '–°–µ—Ä–µ–±—Ä—è–Ω–∞—è —Ä—É–¥–∞', '–†–µ–¥–∫–∞—è —Ä—É–¥–∞ —Å –º–∞–≥–∏—á–µ—Å–∫–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏.', 'uncommon', 'material', '–†—É–¥–∞', '‚õèÔ∏è', 10, 25, true, 30),
('dragon_scale', '–ß–µ—à—É—è –¥—Ä–∞–∫–æ–Ω–∞', '–ü—Ä–æ—á–Ω–∞—è —á–µ—à—É—è, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –æ—Å—Ç–∞—Ç–∫–∏ –¥—Ä–∞–∫–æ–Ω—å–µ–π –º–∞–≥–∏–∏.', 'legendary', 'material', '–ß–µ—à—É—è', 'üê≤', 25, 500, true, 10),
('phoenix_feather', '–ü–µ—Ä–æ —Ñ–µ–Ω–∏–∫—Å–∞', '–†–µ–¥–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –∫—Ä–∞—Ñ—Ç–∏–Ω–≥–∞, –ø—ã–ª–∞—é—â–∏–π –≤–µ—á–Ω—ã–º –æ–≥–Ω–µ–º.', 'mythic', 'material', '–ü–µ—Ä–æ', 'ü™∂', 30, 10000, true, 1),
('magic_crystal', '–ú–∞–≥–∏—á–µ—Å–∫–∏–π –∫—Ä–∏—Å—Ç–∞–ª–ª', '–ö—Ä–∏—Å—Ç–∞–ª–ª –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç –º–∞–≥–∏—á–µ—Å–∫—É—é —ç–Ω–µ—Ä–≥–∏—é.', 'rare', 'material', '–ö—Ä–∏—Å—Ç–∞–ª–ª', 'üíé', 15, 150, true, 20),
('ancient_scroll', '–î—Ä–µ–≤–Ω–∏–π —Å–≤–∏—Ç–æ–∫', '–°—Ç–∞—Ä–∏–Ω–Ω—ã–π —Å–≤–∏—Ç–æ–∫ —Å –∑–∞–±—ã—Ç—ã–º–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è–º–∏.', 'epic', 'material', '–°–≤–∏—Ç–æ–∫', 'üìú', 20, 800, true, 5);

-- –°–ï–¢–û–í–´–ï –ü–†–ï–î–ú–ï–¢–´
INSERT INTO items (item_key, name, description, rarity, type, subtype, icon, level_requirement, base_defense, base_mana, base_crit_chance, base_value, max_durability, set_name, set_bonus) VALUES
('archmage_robe', '–†–æ–±–∞ –∞—Ä—Ö–∏–º–∞–≥–∞', '–ß–∞—Å—Ç—å –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Ç–∞ –≤–µ–ª–∏—á–∞–π—à–µ–≥–æ –º–∞–≥–∞.', 'legendary', 'armor', '–†–æ–±–∞', 'üßô', 25, 80, 150, 10.0, 4000, 120, '–ö–æ–º–ø–ª–µ–∫—Ç –ê—Ä—Ö–∏–º–∞–≥–∞', '2 –ø—Ä–µ–¥–º–µ—Ç–∞: +50 –º–∞–Ω–∞, 4 –ø—Ä–µ–¥–º–µ—Ç–∞: –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è'),
('archmage_hat', '–®–ª—è–ø–∞ –∞—Ä—Ö–∏–º–∞–≥–∞', '–û—Å—Ç—Ä–æ–∫–æ–Ω–µ—á–Ω–∞—è —à–ª—è–ø–∞ —Å –º–∞–≥–∏—á–µ—Å–∫–∏–º–∏ —Ä—É–Ω–∞–º–∏.', 'legendary', 'accessory', '–®–ª—è–ø–∞', 'üé©', 25, 40, 100, 15.0, 3000, 80, '–ö–æ–º–ø–ª–µ–∫—Ç –ê—Ä—Ö–∏–º–∞–≥–∞', '2 –ø—Ä–µ–¥–º–µ—Ç–∞: +50 –º–∞–Ω–∞, 4 –ø—Ä–µ–¥–º–µ—Ç–∞: –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è');

-- –û–±–Ω–æ–≤–ª—è–µ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –ø–æ —Å—Ç–∞—Ç–∞–º –∏ –∫–ª–∞—Å—Å–∞–º
UPDATE items SET class_requirement = '–í–æ–∏–Ω', requirements_stats = '{"defense": 20}' WHERE item_key IN ('plate_armor', 'dragon_scale_armor');
UPDATE items SET class_requirement = '–ú–∞–≥', requirements_stats = '{"mana": 100}' WHERE item_key IN ('enchanted_staff', 'archmage_robe', 'archmage_hat');
UPDATE items SET requirements_stats = '{"level": 30, "crit_chance": 15}' WHERE item_key = 'shadowbane';

-- –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (VIEW) –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–ª–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
CREATE OR REPLACE VIEW items_full AS
SELECT 
    i.*,
    -- –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è –¥–ª—è –æ–±—â–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    (base_damage + COALESCE(inv.bonus_damage, 0)) as total_damage,
    (base_defense + COALESCE(inv.bonus_defense, 0)) as total_defense,
    (base_health + COALESCE(inv.bonus_health, 0)) as total_health,
    (base_mana + COALESCE(inv.bonus_mana, 0)) as total_mana,
    (base_crit_chance + COALESCE(inv.bonus_crit_chance, 0)) as total_crit_chance,
    (base_crit_damage + COALESCE(inv.bonus_crit_damage, 0)) as total_crit_damage,
    (base_speed + COALESCE(inv.bonus_speed, 0)) as total_speed,
    
    -- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (–µ—Å–ª–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞)
    inv.character_id,
    inv.slot_position,
    inv.stack_size,
    inv.current_durability,
    inv.upgrade_level,
    inv.obtained_at
FROM items i
LEFT JOIN character_inventory inv ON i.id = inv.item_id;

COMMENT ON VIEW items_full IS '–ü–æ–ª–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Å —É—á–µ—Ç–æ–º –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è';
